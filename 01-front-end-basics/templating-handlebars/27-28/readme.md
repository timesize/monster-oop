# <img src="https://cloud.githubusercontent.com/assets/7833470/10423298/ea833a68-7079-11e5-84f8-0a925ab96893.png" width="60"> Handlebars Templating

| Objectives |
| :--- |
| Add the Handlebars.js library to your projects |
| Create and compile a Handlebars template |
| Use Handlebars templating to display data from an AJAX call on your HTML page |

## What is a template?

* A **template** is a document (or piece of code) that contains blank spaces for data.

* A **template function** is a function that takes in such a document and data and returns a dynamic HTML string.

* Thus far, we've been using jQuery to append HTML strings to the DOM when we have data to  display in the browser.

* To avoid building long strings of HTML every time we have data to send to the view, we'll use <a href="http://handlebarsjs.com" target="_blank">Handlebars templating</a>. This will allow us to dynamically display data in our HTML. The parameters for our data will live inside `{{}}` tags.

## Why use client-side templating?

* Separate markup from logic. Remember this?

  ```js
  $('#student-list').append('<li class="student">' + firstName + ' - ' + lastName + '</li>');
  ```

  * When appending new HTML elements to the page, the string of elements to append will only get longer as you begin to write more complex markup.

  * Wouldn't it be nice if the HTML structure was already set up for us? That's where templating comes in!

* Maximize code reusability and maintainability.

  * If you need to change your HTML structure for elements you're creating and displaying (e.g. adding an additional class name to your Spotify tracks), all you have to do is change the template!

## A Helpful Metaphor

Think of a **template** as a *mold*, the **data** passed in as *plastic* poured in, and the resulting html string that is generated as a *cast*. 

<img src="http://ecx.images-amazon.com/images/I/81GytL7BBoL._SY355_.jpg" alt="novelty cake tin - bug shaped cakes" width="200">


## Explore Handlebars

We'll use the [HTML strings lab](https://github.com/SF-WDI-LABS/html_strings) as our starting point. Check out the `handelbars` branch. 

### What is happening in `index.html`?

**Create a mold**

1) We make a `script` tag with an `id` that describes what the template will be. The `script` tag should also have `type="text/x-handlebars-template"`; this is important for Handlebars!

2) Using Handlebars, we create a structure we'd like to use for part of the page. Ours is for each student's link. This structure should be inside the script tag. Note the use of `{{ }}` to identify where data will go. 

3) We make sure that the data format we use matches the format of the javascript Object { } that contains the data that we'll use. The example above uses student data. In this example, each student has a `first_name`, a `last_name`, and a `github_username`.


**Set up a factory line**

4) Using `#each` in the template lets Handlebars know we'll want to repeat the structure inside the `#each` for every element of the array. 

### What is happening in `app.js`?

**Select something to mold**

1) Using jQuery we select our `students-list-template` script element.

**Make the mold**

2) We give the element's inner html to Handlebars' `compile` function. Handlebars generates a `template` function for us (our html mold, if you wish).

**Pour the plastic into the mold**

3) The template from our html expects an array of students.  We send the template `data27.students` to use as `students` first. Then we use the template function again with `data28.students` as `students`.

**Open our mold to find a casting!**

4) Each time we call it, the template function returns a string of html that it has generated by mashing the data into the template.

**Put the casting on display**

5) We use jQuery to select the element where we want the new HTML to appear, then append the generated html strings to the page using jQuery.


## General Handlebars Setup Steps

1. Add the Handlebars CDN to your `index.html` (remember you can go to <a href="https://cdnjs.com" target="_blank">cdnjs</a> to search for CDNs). Make sure to require Handlebars before your custom script file.

2. Next create an element in your `index.html` where you will append the data from your template. Give this element an `id` (e.g. `results`) so you can select it very specifically with jQuery.

3. Create an element where you'll append the elements generated by Handlebars, and give it an id so you can select it later. Then create a `script` element; this is your template! Give your template script an `id` (e.g. `students-list-template`) so you can select it with jQuery. This template acts as an HTML "mad lib", "mold", or "cake pan" which you'll fill with data. The `{{}}` parameters will be replaced by the data that comes back from your API call.

4. Compile your template in `app.js`. Handlebars has a function called `Handlebars.compile(source)`. The source it takes in is the html from inside your template script. Handlebars' `compile` function returns a function, which we'll save to a variable called `template`. This isn't a special varible name; it just reminds us what the function does.


5. Pass the data you want to display into your `template` function.  If you're getting data from an AJAX call, you'll want to do this once the call has been successful. The output of the template function is an HTML string that contains your data. Make sure you give the `template` function an object with data to fill in each blank from your html template. 

6. The last step is to append the new HTML string to the view.

 

## Challenges

* Refactor your Spotify Search app to use Handlebars templating. Feel free to pull down the `solution` branch if you want to start with fresh code.


*Note: When using an array in a Handlebars template, we need an extra `.` to access a value from inside it by index (this syntax is specific to Handlebars)*. So `{{arr.[0]}}` gives us the first value from the array -- in Handlebars **only**.



## Resources

* <a href="http://handlebarsjs.com" target="_blank">Handlebars.js</a>
